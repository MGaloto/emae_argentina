name: Dashboard Refresh

on: 
  push:
    branches: [main]
  schedule:  
    - cron: '0 21 1 * *' # el dia 1 del mes a las 18 hs argentina
    # - cron:  '0 */12 * * *'
    # cada doce horas '0 */12 * * *'
    # cada 10 min '*/10 * * * *'

permissions: write-all

jobs:
  refresh-the-dashboard:
    runs-on: ubuntu-latest  # version mas reciente de ubuntu
    container: 
      image: mgaloto/flexdashiny_01
    steps:
    - name: checkout_repo
      uses: actions/checkout@v3
      with: 
        ref: 'main'


    - name: Render Rmarkdown
      run: |
        rmarkdown::render_site()
      shell: Rscript {0}
      
    - name: Commit files
      run: |
        git config --local user.email "actions@github.com"
        git config --local user.name "GitHub Actions"
        git add --all
        git commit -am "add data"
        git push 
