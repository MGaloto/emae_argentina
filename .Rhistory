gridLineWidth = 0,
dateTimeLabelFormats = list(day = '%d/%m/%Y'),
type = "datetime",
reversed = FALSE
) %>%
highcharter::hc_yAxis(
title = list(text = str_to_title(gsub("_", " ", name))),
gridLineWidth = 0,
reversed = FALSE
) %>%
highcharter::hc_caption(
text = paste0("Serie Temporal de EMAE. Año Base Enero 2004. <br>Fuente: Indec.")) %>%
highcharter::hc_tooltip(
crosshairs = TRUE,
backgroundColor = "#F0F0F0",
shared = TRUE,
borderWidth = 5
)
}
dtfs = most_interanual(dataframe)
interanual_value = interanual(dataframe, "emae")
valuebox(interanual_value, name= "EMAE",color="rgb(232, 221, 64)", font="font-size: 100%; color: #291e1e")
most_name = dtfs[order(-dtfs$values),]$names[1]
most_value = dtfs[order(-dtfs$values),]$values[1]
valuebox(most_value, name= most_name, color="	#800000", font="font-size: 100%; color: #ffffff")
min_name = dtfs[order(dtfs$values),]$names[1]
min_value = dtfs[order(dtfs$values),]$values[1]
valuebox(min_value, name= min_name,color="#a61425", font="font-size: 100%; color: #ffffff")
time_serie_plot(data = dataframe, name = "emae")
time_serie_plot(data = dataframe, name = "mineria")
# "bootstrap", "cerulean", "cosmo", "darkly", "flatly", "journal", "lumen", "", "", "spacelab",
# logo: https://convert-my-image.com/ImageConverter
library(flexdashboard)
library(dplyr)
library(tidyverse)
library(highcharter)
#source('download_emae.R')
dataframe = readxl::read_excel("df.xlsx")
interanual <-    function(df, val)  {
valueuno = pull((df[,c(val)]))[nrow(df) - 12]
valuedos = pull((df[,c(val)]))[nrow(df)]
porcentaje = round(((valuedos - valueuno) / valueuno ) * 100,1)
return(porcentaje)
}
most_interanual = function(df){
col_names = colnames(df)[1:16]
counter = 0
values = c()
names = c()
for (col in col_names){
counter = counter + 1
valueuno = pull((df[,c(col)]))[nrow(df) - 12]
valuedos = pull((df[,c(col)]))[nrow(df)]
porcentaje = round(((valuedos - valueuno) / valueuno ) * 100,1)
values[counter] <- porcentaje
names[counter] <- col
}
dtf = data.frame(names,values)
return(dtf)
}
valuebox = function(porcentaje, name, color, font) {
valueBox(
value = tags$p(paste0(porcentaje, ' %'),
style = color),
icon = "fa-diamond",
caption = tags$p(paste0('Variacion Interanual de: ',str_to_title(gsub("_", " ", name))),
style = font),
color =  color)
}
time_serie_plot = function(data, name){
highcharter::hchart(
data, type = "line",  highcharter::hcaes(x = "periodos", y = !!sym(name)),
color = "rgba(29, 53, 87, 1)",
name = str_to_title(gsub("_", " ", name)),
id = "trend",
showInLegend = TRUE) %>%
highcharter::hc_tooltip(crosshairs = TRUE, pointFormat = "Base: {point.y}") %>%
highcharter::hc_plotOptions(
line = list(
color = "blue",
marker = list(
fillColor = "white",
lineWidth = 2,
radius=1,
lineColor = NULL
)
)
) %>%
highcharter::hc_legend(
layout = "vertical",
verticalAlign = "top",
align = "right",
floating = TRUE
) %>%
highcharter::hc_xAxis(
title = list(text = ""),
gridLineWidth = 0,
dateTimeLabelFormats = list(day = '%d/%m/%Y'),
type = "datetime",
reversed = FALSE
) %>%
highcharter::hc_yAxis(
title = list(text = str_to_title(gsub("_", " ", name))),
gridLineWidth = 0,
reversed = FALSE
) %>%
highcharter::hc_caption(
text = paste0("Serie Temporal de EMAE. Año Base Enero 2004. <br>Fuente: Indec.")) %>%
highcharter::hc_tooltip(
crosshairs = TRUE,
backgroundColor = "#F0F0F0",
shared = TRUE,
borderWidth = 5
)
}
dtfs = most_interanual(dataframe)
time_serie_plot(data = dataframe, name = "emae")
View(dataframe)
time_serie_plot = function(data, name){
highcharter::hchart(
data, type = "line",  highcharter::hcaes(x = "periodos", y = name),
color = "rgba(29, 53, 87, 1)",
name = str_to_title(gsub("_", " ", name)),
id = "trend",
showInLegend = TRUE) %>%
highcharter::hc_tooltip(crosshairs = TRUE, pointFormat = "Base: {point.y}") %>%
highcharter::hc_plotOptions(
line = list(
color = "blue",
marker = list(
fillColor = "white",
lineWidth = 2,
radius=1,
lineColor = NULL
)
)
) %>%
highcharter::hc_legend(
layout = "vertical",
verticalAlign = "top",
align = "right",
floating = TRUE
) %>%
highcharter::hc_xAxis(
title = list(text = ""),
gridLineWidth = 0,
dateTimeLabelFormats = list(day = '%d/%m/%Y'),
type = "datetime",
reversed = FALSE
) %>%
highcharter::hc_yAxis(
title = list(text = str_to_title(gsub("_", " ", name))),
gridLineWidth = 0,
reversed = FALSE
) %>%
highcharter::hc_caption(
text = paste0("Serie Temporal de EMAE. Año Base Enero 2004. <br>Fuente: Indec.")) %>%
highcharter::hc_tooltip(
crosshairs = TRUE,
backgroundColor = "#F0F0F0",
shared = TRUE,
borderWidth = 5
)
}
time_serie_plot(data = dataframe, name = "emae")
highcharter::hchart(
data, type = "line",  highcharter::hcaes(x = "periodos", y = "emae"),
color = "rgba(29, 53, 87, 1)",
name = str_to_title(gsub("_", " ", "emae")),
id = "trend",
showInLegend = TRUE) %>%
highcharter::hc_tooltip(crosshairs = TRUE, pointFormat = "Base: {point.y}") %>%
highcharter::hc_plotOptions(
line = list(
color = "blue",
marker = list(
fillColor = "white",
lineWidth = 2,
radius=1,
lineColor = NULL
)
)
) %>%
highcharter::hc_legend(
layout = "vertical",
verticalAlign = "top",
align = "right",
floating = TRUE
) %>%
highcharter::hc_xAxis(
title = list(text = ""),
gridLineWidth = 0,
dateTimeLabelFormats = list(day = '%d/%m/%Y'),
type = "datetime",
reversed = FALSE
) %>%
highcharter::hc_yAxis(
title = list(text = str_to_title(gsub("_", " ", name))),
gridLineWidth = 0,
reversed = FALSE
) %>%
highcharter::hc_caption(
text = paste0("Serie Temporal de EMAE. Año Base Enero 2004. <br>Fuente: Indec.")) %>%
highcharter::hc_tooltip(
crosshairs = TRUE,
backgroundColor = "#F0F0F0",
shared = TRUE,
borderWidth = 5
)
colnames(dataframe$pesca)
dataframe$pesca
names(dataframe$pesca)
name(dataframe$pesca)
dataframe$pesca
time_serie_plot = function(data, name, x, y){
highcharter::hchart(
data, type = "line",  highcharter::hcaes(x = x, y = y),
color = "rgba(29, 53, 87, 1)",
name = str_to_title(gsub("_", " ", name)),
id = "trend",
showInLegend = TRUE) %>%
highcharter::hc_tooltip(crosshairs = TRUE, pointFormat = "Base: {point.y}") %>%
highcharter::hc_plotOptions(
line = list(
color = "blue",
marker = list(
fillColor = "white",
lineWidth = 2,
radius=1,
lineColor = NULL
)
)
) %>%
highcharter::hc_legend(
layout = "vertical",
verticalAlign = "top",
align = "right",
floating = TRUE
) %>%
highcharter::hc_xAxis(
title = list(text = ""),
gridLineWidth = 0,
dateTimeLabelFormats = list(day = '%d/%m/%Y'),
type = "datetime",
reversed = FALSE
) %>%
highcharter::hc_yAxis(
title = list(text = str_to_title(gsub("_", " ", name))),
gridLineWidth = 0,
reversed = FALSE
) %>%
highcharter::hc_caption(
text = paste0("Serie Temporal de EMAE. Año Base Enero 2004. <br>Fuente: Indec.")) %>%
highcharter::hc_tooltip(
crosshairs = TRUE,
backgroundColor = "#F0F0F0",
shared = TRUE,
borderWidth = 5
)
}
time_serie_plot(data = dataframe, name = "emae", x=dataframe$periodos,y=dataframe$emae)
# "bootstrap", "cerulean", "cosmo", "darkly", "flatly", "journal", "lumen", "", "", "spacelab",
# logo: https://convert-my-image.com/ImageConverter
library(flexdashboard)
library(dplyr)
library(tidyverse)
library(highcharter)
library(rlang)
#source('download_emae.R')
dataframe = readxl::read_excel("df.xlsx")
interanual <-    function(df, val)  {
valueuno = pull((df[,c(val)]))[nrow(df) - 12]
valuedos = pull((df[,c(val)]))[nrow(df)]
porcentaje = round(((valuedos - valueuno) / valueuno ) * 100,1)
return(porcentaje)
}
most_interanual = function(df){
col_names = colnames(df)[1:16]
counter = 0
values = c()
names = c()
for (col in col_names){
counter = counter + 1
valueuno = pull((df[,c(col)]))[nrow(df) - 12]
valuedos = pull((df[,c(col)]))[nrow(df)]
porcentaje = round(((valuedos - valueuno) / valueuno ) * 100,1)
values[counter] <- porcentaje
names[counter] <- col
}
dtf = data.frame(names,values)
return(dtf)
}
valuebox = function(porcentaje, name, color, font) {
valueBox(
value = tags$p(paste0(porcentaje, ' %'),
style = color),
icon = "fa-diamond",
caption = tags$p(paste0('Variacion Interanual de: ',str_to_title(gsub("_", " ", name))),
style = font),
color =  color)
}
time_serie_plot = function(data, name, x, y){
highcharter::hchart(
data, type = "line",  highcharter::hcaes(x = as.Date(periodos), y = y),
color = "rgba(29, 53, 87, 1)",
name = str_to_title(gsub("_", " ", name)),
id = "trend",
showInLegend = TRUE) %>%
highcharter::hc_tooltip(crosshairs = TRUE, pointFormat = "Base: {point.y}") %>%
highcharter::hc_plotOptions(
line = list(
color = "blue",
marker = list(
fillColor = "white",
lineWidth = 2,
radius=1,
lineColor = NULL
)
)
) %>%
highcharter::hc_legend(
layout = "vertical",
verticalAlign = "top",
align = "right",
floating = TRUE
) %>%
highcharter::hc_xAxis(
title = list(text = ""),
gridLineWidth = 0,
dateTimeLabelFormats = list(day = '%d/%m/%Y'),
type = "datetime",
reversed = FALSE
) %>%
highcharter::hc_yAxis(
title = list(text = str_to_title(gsub("_", " ", name))),
gridLineWidth = 0,
reversed = FALSE
) %>%
highcharter::hc_caption(
text = paste0("Serie Temporal de EMAE. Año Base Enero 2004. <br>Fuente: Indec.")) %>%
highcharter::hc_tooltip(
crosshairs = TRUE,
backgroundColor = "#F0F0F0",
shared = TRUE,
borderWidth = 5
)
}
dtfs = most_interanual(dataframe)
time_serie_plot(data = dataframe, name = "emae")
# "bootstrap", "cerulean", "cosmo", "darkly", "flatly", "journal", "lumen", "", "", "spacelab",
# logo: https://convert-my-image.com/ImageConverter
library(flexdashboard)
library(dplyr)
library(tidyverse)
library(highcharter)
library(rlang)
#source('download_emae.R')
dataframe = readxl::read_excel("df.xlsx")
interanual <-    function(df, val)  {
valueuno = pull((df[,c(val)]))[nrow(df) - 12]
valuedos = pull((df[,c(val)]))[nrow(df)]
porcentaje = round(((valuedos - valueuno) / valueuno ) * 100,1)
return(porcentaje)
}
most_interanual = function(df){
col_names = colnames(df)[1:16]
counter = 0
values = c()
names = c()
for (col in col_names){
counter = counter + 1
valueuno = pull((df[,c(col)]))[nrow(df) - 12]
valuedos = pull((df[,c(col)]))[nrow(df)]
porcentaje = round(((valuedos - valueuno) / valueuno ) * 100,1)
values[counter] <- porcentaje
names[counter] <- col
}
dtf = data.frame(names,values)
return(dtf)
}
valuebox = function(porcentaje, name, color, font) {
valueBox(
value = tags$p(paste0(porcentaje, ' %'),
style = color),
icon = "fa-diamond",
caption = tags$p(paste0('Variacion Interanual de: ',str_to_title(gsub("_", " ", name))),
style = font),
color =  color)
}
time_serie_plot = function(data, name){
highcharter::hchart(
data, type = "line",  highcharter::hcaes(x = as.Date(periodos), y = rlang::sym(name)),
color = "rgba(29, 53, 87, 1)",
name = str_to_title(gsub("_", " ", name)),
id = "trend",
showInLegend = TRUE) %>%
highcharter::hc_tooltip(crosshairs = TRUE, pointFormat = "Base: {point.y}") %>%
highcharter::hc_plotOptions(
line = list(
color = "blue",
marker = list(
fillColor = "white",
lineWidth = 2,
radius=1,
lineColor = NULL
)
)
) %>%
highcharter::hc_legend(
layout = "vertical",
verticalAlign = "top",
align = "right",
floating = TRUE
) %>%
highcharter::hc_xAxis(
title = list(text = ""),
gridLineWidth = 0,
dateTimeLabelFormats = list(day = '%d/%m/%Y'),
type = "datetime",
reversed = FALSE
) %>%
highcharter::hc_yAxis(
title = list(text = str_to_title(gsub("_", " ", name))),
gridLineWidth = 0,
reversed = FALSE
) %>%
highcharter::hc_caption(
text = paste0("Serie Temporal de EMAE. Año Base Enero 2004. <br>Fuente: Indec.")) %>%
highcharter::hc_tooltip(
crosshairs = TRUE,
backgroundColor = "#F0F0F0",
shared = TRUE,
borderWidth = 5
)
}
dtfs = most_interanual(dataframe)
time_serie_plot(data = dataframe, name = "emae")
packageVersion(XML)
library(tidyverse)
library(lubridate)
library(readxl)
library(readr)
library(httr)
library(XML)
packageVersion(XML)
packageVersion("XML")
library(tidyverse)
library(lubridate)
library(readxl)
library(readr)
library(httr)
#library(XML)
packageVersion("XML")
convert_integer = function(dataframe) {
dataframe[ , c(1:(ncol(dataframe)))] = apply(dataframe[ , c(1:(ncol(dataframe)))], 2,
function(x) as.numeric(as.character(x)))
return(
dataframe
)
}
get_dataframe = function(url, time_out){
GET(url,
timeout(time_out),
write_disk(file <- tempfile(fileext = ".xls")))
emae = read_excel(file)
if (grepl("mensual", url)) {
emae = emae[7:nrow(emae) - 2,3]
colnames(emae) = "emae"
emae = na.omit(emae)
emae = convert_integer(emae)
dataframe = emae %>%
mutate_if(is.numeric, round)
} else {
emae = emae[4:nrow(emae) - 2,]
colnames(emae) = emae[1,]
emae = emae[4:nrow(emae), 3:ncol(emae)]
emae = na.omit(emae)
emae = convert_integer(emae)
colnames(emae) = c("agricultura_ganaderia",
"pesca",
"mineria",
"industria_manufactura",
"electricidad_gas_agua",
"construccion",
"comercio",
"hoteles_restaurantes",
"transporte_comunicaciones",
"intermediacion_financiera",
"inmobiliarias",
"adm_publica",
"enseñanza",
"serv_sociales_salud",
"serv_comunitarios_sociales",
"impuestos_neto_subsidios")
periodos = seq(as.Date("2004/1/1"),
by = "month",
length.out = nrow(emae))
emae$periodos = as.Date(periodos)
emae$year     = year(emae$periodos)
emae$Mes      = as.numeric(substr(emae$periodos, 6 , 7))
dataframe = emae %>%
mutate_if(is.numeric, round)
}
return(dataframe)
}
url_sectors = "https://www.indec.gob.ar/ftp/cuadros/economia/sh_emae_actividad_base2004.xls"
url = "https://www.indec.gob.ar/ftp/cuadros/economia/sh_emae_mensual_base2004.xls"
df_emae = get_dataframe(url = url, time_out = 20000)
dataframe = get_dataframe(url = url_sectors, time_out = 20000)
dataframe$emae = df_emae$emae
rm(df_emae)
packageVersion("readr")
